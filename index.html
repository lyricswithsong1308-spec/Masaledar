<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Mobile Car Demo</title>
<style>
body { margin:0; overflow:hidden; background:#222;}
#tilt { position:absolute; bottom:10px; left:10px; width:80%; }
#info { position:absolute; top:10px; left:10px; color:white; font-family:Arial; font-size:16px; background:rgba(0,0,0,0.5); padding:5px; }
</style>
</head>
<body>
<div id="info">Drag to rotate. Use slider to tilt car.</div>
<input type="range" id="tilt" min="-30" max="30" value="0">

<script src="https://cdn.jsdelivr.net/npm/three@0.161.0/build/three.min.js"></script>

<script>
// Scene, Camera, Renderer
let scene = new THREE.Scene();
scene.background = new THREE.Color(0x222222);

let camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
camera.position.set(10,5,15);

let renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

// --- Simple touch rotation ---
let startX, startY, isDragging = false;
document.addEventListener('touchstart', e => { isDragging=true; startX=e.touches[0].clientX; startY=e.touches[0].clientY; });
document.addEventListener('touchmove', e => {
    if(!isDragging) return;
    let dx = e.touches[0].clientX - startX;
    if(car) car.rotation.y += dx * 0.01;
    startX = e.touches[0].clientX;
});
document.addEventListener('touchend', e=>{isDragging=false;});

// Lights
let ambient = new THREE.AmbientLight(0xffffff,1);
scene.add(ambient);
let dirLight = new THREE.DirectionalLight(0xffffff,0.8);
dirLight.position.set(5,10,5);
scene.add(dirLight);

// --- Floor ---
let ground = new THREE.Mesh(
    new THREE.PlaneGeometry(50,50),
    new THREE.MeshStandardMaterial({color:0x444444})
);
ground.rotation.x = -Math.PI/2;
ground.position.y = 0;
scene.add(ground);

// --- Car Group ---
let car = new THREE.Group();

// Scale car to make it visible on mobile
car.scale.set(3,3,3);

// Car body
let bodyGeo = new THREE.BoxGeometry(4,1,2);
let bodyMat = new THREE.MeshStandardMaterial({color:0xff0000});
let bodyMesh = new THREE.Mesh(bodyGeo, bodyMat);
bodyMesh.position.y = 1;
car.add(bodyMesh);

// Wheels
let wheelGeo = new THREE.CylinderGeometry(0.5,0.5,0.5,16);
let wheelMat = new THREE.MeshStandardMaterial({color:0x333333});
let wheels = [];
let positions = [[-1.5,0.5,1],[1.5,0.5,1],[-1.5,0.5,-1],[1.5,0.5,-1]];
for(let pos of positions){
    let w = new THREE.Mesh(wheelGeo, wheelMat);
    w.rotation.z = Math.PI/2;
    w.position.set(pos[0],pos[1],pos[2]);
    car.add(w);
    wheels.push(w);
}

// Center of mass
let com = new THREE.Mesh(new THREE.SphereGeometry(0.2,16,16), new THREE.MeshStandardMaterial({color:0xffff00}));
com.position.set(0,1,0);
car.add(com);

scene.add(car);

// --- Tilt Slider ---
let tilt = document.getElementById('tilt');
tilt.addEventListener('input', ()=>{
    car.rotation.z = tilt.value * Math.PI/180;
});

// --- Animate wheels and car ---
let carSpeed = 0.05; // forward movement speed
function animate(){
    requestAnimationFrame(animate);

    // Spin wheels
    for(let w of wheels) w.rotation.y -= 0.2;

    // Move car forward
    car.position.x += carSpeed;

    renderer.render(scene,camera);
}
animate();

// --- Resize ---
window.addEventListener('resize', ()=>{
    camera.aspect = window.innerWidth/window.innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(window.innerWidth, window.innerHeight);
});
</script>
</body>
</html>
